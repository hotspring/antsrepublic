!function(){$(document).ready(function(){$(".attachment_file_upload").fileupload({dataType:"json",done:function(a,n){var t=n.result;$("#plan_task_"+t.attachmentable_id+" .task-result-files ul").prepend('<li><a href="'+t.file_url+'">'+t.file_name+"</a></li>"),console.log()}}),$(".deadLineDataPicker").datetimepicker({format:"yyyy-mm-dd",autoclose:!0,minView:2,language:"zh-CN"}),$(".responsive-calendar").responsiveCalendar({time:"2016-08",events:taskData}),$(".updatePlanBtn").click(function(n){var t=$(n.currentTarget).attr("data-plan"),l="#plan_f_"+t,e=$(l).serialize(),i="/api/plans/"+t;$.ajax({method:"PATCH",url:i,data:e}).done(function(n){var t=n.plan,l=$("#plan-unit-"+t.id+" .plan-output");l.find("span.plan-time").html(t.dead_line),l.find("span.plan-title").html(t.title),a(t.id)})}),$(".delPlanBtn").click(function(a){var n=$(a.currentTarget).attr("data-plan"),t="/api/plans/"+n;$.ajax({method:"DELETE",url:t}).done(function(){$("#plan-unit-"+n).remove()})}),$(".createPlanBtn").click(function(a){var t=$(a.currentTarget).attr("data-need"),l=$("#create_plan_form").serializeArray();$.ajax({method:"POST",url:"/api/needs/"+t+"/plans",data:l}).done(function(a){$(".collapse#new-plan-form").before(n(a.plan_id,l[0].value,l[1].value)),$(".collapse#new-plan-form").collapse("toggle")})}),$(".editPlanBtn").click(function(n){var t=$(n.currentTarget).attr("data-plan");a(t)}),$(".cancleUpdateplanBtn").click(function(n){var t=$(n.currentTarget).attr("data-plan");a(t)})});var a=function(a){$("#plan-unit-"+a+" .plan-output").toggleClass("hidden"),$("#plan-unit-"+a+" .plan-input").toggleClass("hidden")},n=function(a,n,t){return"\t<div class='plan-unit' id='plan-unit-"+a+"'>  <div class='plan-output'>    <span class='plan-time'>"+n+"</span>    <span class='plan-title'>"+t+"</span>    <span class='plan-action'>      <a class='editplanBtn' data-plan='"+a+"' href='javascript:void(0)'>\u7f16\u8f91</a>      <a class='delplanBtn' data-plan='"+a+"' href='javascript:void(0)'>\u5220\u9664</a>    </span>  </div>  <div class='plan-input hidden'>    <form id='plan_f_"+a+"'>      <span class='plan-time'>\t\t<div class='form-group'>        <input class='form-control deadLineDataPicker' type='text' name='plan[dead_line]' placeholder='\u8bf7\u9009\u62e9\u65e5\u671f' readonly value='"+n+"'>\t\t</div>      </span>      <span class='plan-title'>\t\t<div class='form-group'>        <input class='form-control' type='text' name='plan[title]' value='"+t+"'>\t\t</div>      </span>      <span class='plan-action'>        <a class='updateplanBtn' data-plan='"+a+"' href='javascript:void(0)'>\u4fdd\u5b58</a>        <a class='cancleUpdateplanBtn' data-plan='"+a+"' href='javascript:void(0)'>\u53d6\u6d88</a>      </span>    </form>  </div></div>"}}();